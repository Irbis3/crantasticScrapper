library(recurrentR)

x <-
	c(0.16425559122691, 0.258722013083055, 0.307182678500108, 0.331257905973645, 
		0.374680400906924, 0.550446152077505, 0.566225113767829, 0.579154406413274, 
		0.630011820800402, 0.675956754944918, 0.730985875566675, 0.74012406437142, 
		0.782365638738268, 0.795013527370056, 0.804789721386245, 0.819667524409251, 
		0.823528313144382, 0.914329445446435, 0.93475478969545, 0.936215557312387, 
		0.958094261038626, 1.01998702549471, 1.02495589796101, 1.05371655744476, 
		1.11008022338781, 1.11047477052216, 1.12742787007992, 1.13822308849182, 
		1.14432123554542, 1.15365986096885, 1.17356140609924, 1.21969344784382, 
		1.22506037895133, 1.23332846179877, 1.23564413566846, 1.23775302795471, 
		1.30931680960925, 1.33632220501583, 1.35091329791512, 1.35381482039926, 
		1.35769200562389, 1.38744572920709, 1.39134550145501, 1.39539343782211, 
		1.43196431172299, 1.43719801962291, 1.44933884676575, 1.45323905739992, 
		1.47919111320447, 1.50199582324851, 1.50632789614848, 1.51320945969991, 
		1.52392427156917, 1.52628214283175, 1.54060405106366, 1.56582752028065, 
		1.56935411849796, 1.59878039508318, 1.61593845758073, 1.61610897386996, 
		1.63839567690888, 1.69450554856197, 1.74200155744579, 1.75387374035898, 
		1.75949555720142, 1.84646831084065, 1.84898270044341, 1.85490206304988, 
		1.86738736335964, 1.87840011434271, 1.87901478764998, 1.94529583494689, 
		1.98192508243336, 2.00741712417598, 2.06340287421133, 2.15301827406354, 
		2.16704937756948, 2.18428605546389, 2.20100407247831, 2.20154958468652, 
		2.21364487303769, 2.23115225313182, 2.23144613688996, 2.29838652193459, 
		2.30419434858409, 2.30780402608494, 2.324513042241, 2.33686503886382, 
		2.34276639395275, 2.38830637313495, 2.40435567120219, 2.42045348001864, 
		2.45787419407408, 2.46463894927253, 2.46931991160048, 2.47002997244529, 
		2.47324873293912, 2.47906480410733, 2.49392027542793, 2.51077078565486, 
		2.53401476241284, 2.54292772037771, 2.55026311482661, 2.59146862507805, 
		2.59296908414098, 2.5993122891176, 2.62333669485671, 2.6239011551391, 
		2.64735369364182, 2.66679865752899, 2.66697558607072, 2.67225428851276, 
		2.68709649252025, 2.73187396173086, 2.78719920503409, 2.818362596361, 
		2.83813642435798, 2.86313834482564, 2.86612539023593, 2.88234469612258, 
		2.88447306581578, 2.96492944802871, 3.0114999483386, 3.01968968688135, 
		3.03819209243564, 3.04497728871166, 3.06748225078064, 3.09192845240784, 
		3.13751834958502, 3.13881677665765, 3.19531424100015, 3.20084958505873, 
		3.2065857959812, 3.21079113224435, 3.23689115360731, 3.23738379412675, 
		3.2409068074842, 3.25780073492672, 3.30842572687796, 3.31250398949274, 
		3.32498679822137, 3.33836214295395, 3.35562893165473, 3.36088914076864, 
		3.42143568005553, 3.42759890939138, 3.4877506095362, 3.52251308252804, 
		3.54701421641001, 3.6066870231095, 3.61378521418612, 3.63636979559042, 
		3.65810660867166, 3.66492324452114, 3.68301266588402, 3.69743383619422, 
		3.74964955290488, 3.7786221864543, 3.78296338037195, 3.79067249234091, 
		3.83073995341195, 3.85519348326436, 3.86270886428493, 3.86342707322805, 
		3.87225367548416, 3.90896443873904, 3.91385919267205, 3.92665327178444, 
		3.95844519088837, 3.9961340139808, 3.99845768218958, 4.01645874089343, 
		4.07050060874805, 4.12268062104669, 4.14435107481306, 4.20086883013815, 
		4.21598675786241, 4.24905747079327, 4.25446600003234, 4.27251212769884, 
		4.37535143406948, 4.3851484728056, 4.39190902063667, 4.40629197819678, 
		4.41620552899606, 4.41927417134297, 4.47911487075448, 4.48181723504221, 
		4.51004589261294, 4.52364783023223, 4.54664911678919, 4.58636981352733, 
		4.6264773127961, 4.62978285390972, 4.66761242429586, 4.67587240368433, 
		4.67770080711019, 4.68578372133056, 4.71098359584863, 4.74292350458362, 
		4.76280537925847, 4.77570158263007, 4.77982688190348, 4.80203018923126, 
		4.84962872873751, 4.874766608544, 4.91582835934255, 4.95416582199045, 
		5.04007600863136, 5.07882918370525, 5.1913464774147, 5.27254569244776, 
		5.28125592268267, 5.2965253413479, 5.33330515271584, 5.35418652447227, 
		5.4010160405717, 5.40790191479479, 5.42559056819664, 5.42821310656679, 
		5.43021930465585, 5.45233711465633, 5.48199263012123, 5.5020790303564, 
		5.60865876483424, 5.6130630980695, 5.61465167761875, 5.61625945764811, 
		5.62315288793041, 5.6333155884135, 5.64092559655239, 5.65799499342576, 
		5.68845105493102, 5.69216249523226, 5.71542931820217, 5.74793249021287, 
		5.7602026919278, 5.77979614760903, 5.78222588691079, 5.85506823269872, 
		5.86094250038456, 5.93144844318094, 5.94354387187841, 6.00151392391181, 
		6.09152684708762, 6.23742264049702, 6.25557713704668, 6.25860948066597, 
		6.32863363206954, 6.34918091760826, 6.36564976556382, 6.4635291912772, 
		6.47748508215725, 6.54680583341309, 6.56520212595049, 6.62312913413612, 
		6.67509411688496, 6.70862972821395, 6.71887215191555, 6.88290572329508, 
		6.88373087390882, 7.14687763015635, 7.14805245369462, 7.18898473718, 
		7.20684851896946, 7.23745455915823, 7.27881989537533, 7.28548705370732, 
		7.33481669602352, 7.39282616213746, 7.39653923283419, 7.41275024786882, 
		7.48439484614429, 7.52955174975324, 7.57359442193914, 7.67287718311615, 
		7.69956596359804, 7.71116381859489, 7.77607888496141, 7.80293883986406, 
		7.90124945937542, 8.01337044783115, 8.13525933116921, 8.16434500326681, 
		8.16650706700301, 8.28804579547392, 8.40600532452083, 8.58777066619187, 
		8.65770664316277, 8.7124471417403, 8.72718087548663, 8.74355524207515, 
		8.79425290020565, 8.8915366276084, 8.91962146727576, 9.02240675891684, 
		9.17341043154349, 9.35229807955803, 9.35893213046309, 9.55390742427247, 
		9.57331264979949, 9.63446756058172, 9.68226496763955, 9.73299660332589
	)
a <-
	3.01968968688135
b <-
	10

library(rbenchmark)
benchmark(
	r1 <- which(x >= a & x <= b),
	r2 <- .Call("substring_index", x, a, b, PACKAGE="recurrentR")
	)
all(r1 == r2)

for(i in 1:1000) {
	a <- runif(1, 0, 10)
	b <- runif(1, 0, 10)
	r1 <- which(x >= a & x <= b)
	r2 <- .Call("substring_index", x, a, b, PACKAGE="recurrentR")
	all(r1 == r2)
}
